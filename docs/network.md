# 05. 네트워크 (Computer Networks)

---

## 1. 네트워크 기본 개념

### 주요 용어

| 용어 | 설명 |
|------|------|
| **Socket** | 네트워크 통신의 끝점, IP + Port 조합 |
| **Proxy** | 클라이언트와 서버 사이의 중계 서버 |
| **PDU** | Protocol Data Unit, 각 계층의 데이터 단위 |
| **ISP** | Internet Service Provider, 인터넷 서비스 제공자 |

### Circuit Switching vs Packet Switching

| 구분 | Circuit Switching | Packet Switching |
|------|-------------------|------------------|
| 연결 | 전용 경로 설정 | 경로 공유 |
| 자원 | 통화 중 독점 | 필요할 때만 사용 |
| 예시 | 전통적 전화망 | 인터넷 |
| 효율성 | 낮음 | 높음 |

### Packet 손실 원인

- 라우터 버퍼 오버플로우
- 네트워크 혼잡
- 전송 오류
- TTL 만료

---

## 2. OSI 7계층

### ⭕ OSI 7계층과 TCP/IP 4계층을 비교하라

```
OSI 7계층                    TCP/IP 4계층
┌─────────────────┐         ┌─────────────────┐
│  7. 응용 계층    │         │                 │
├─────────────────┤         │  응용 계층       │
│  6. 표현 계층    │         │  (Application)  │
├─────────────────┤         │                 │
│  5. 세션 계층    │         │                 │
├─────────────────┤         ├─────────────────┤
│  4. 전송 계층    │         │  전송 계층       │
│                 │         │  (Transport)    │
├─────────────────┤         ├─────────────────┤
│  3. 네트워크 계층 │         │  인터넷 계층     │
│                 │         │  (Internet)     │
├─────────────────┤         ├─────────────────┤
│  2. 데이터링크   │         │  네트워크 접근   │
├─────────────────┤         │  (Network       │
│  1. 물리 계층    │         │   Access)       │
└─────────────────┘         └─────────────────┘
```

### 각 계층별 역할과 PDU

| 계층 | 역할 | PDU | 프로토콜/장비 |
|------|------|-----|--------------|
| 7. 응용 | 사용자 인터페이스 | 데이터 | HTTP, FTP, SMTP, DNS |
| 6. 표현 | 데이터 변환, 암호화 | 데이터 | SSL/TLS, JPEG |
| 5. 세션 | 연결 관리 | 데이터 | NetBIOS |
| 4. 전송 | 종단간 통신 | 세그먼트 | TCP, UDP |
| 3. 네트워크 | 라우팅, 주소 지정 | 패킷 | IP, ICMP, 라우터 |
| 2. 데이터링크 | 프레임 전송, MAC 주소 | 프레임 | Ethernet, 스위치 |
| 1. 물리 | 비트 전송 | 비트 | 케이블, 허브 |

---

## 3. TCP/IP

### ⭕ TCP와 UDP의 차이는?

| 구분 | TCP | UDP |
|------|-----|-----|
| 연결 | 연결 지향 (3-way handshake) | 비연결 |
| 신뢰성 | 보장 (재전송, 순서 보장) | 보장 안 함 |
| 속도 | 상대적으로 느림 | 빠름 |
| 헤더 크기 | 20-60 bytes | 8 bytes |
| 흐름/혼잡 제어 | 있음 | 없음 |
| 용도 | 웹, 이메일, 파일 전송 | 스트리밍, DNS, 게임 |

### ⭕ TCP 3-way Handshake를 설명하라

```
Client                    Server
   │                         │
   │──── SYN (seq=x) ──────▶│
   │                         │
   │◀── SYN-ACK ────────────│
   │    (seq=y, ack=x+1)     │
   │                         │
   │──── ACK (ack=y+1) ────▶│
   │                         │
   │      연결 수립 완료       │
```

TCP 연결 수립 과정으로, 클라이언트가 SYN을 보내고, 서버가 SYN-ACK를 응답하고, 클라이언트가 ACK를 보내면 연결이 수립된다. 양방향 통신을 위한 시퀀스 번호를 교환한다.

### TCP 4-way Handshake (연결 종료)

```
Client                    Server
   │                         │
   │──── FIN ──────────────▶│
   │                         │
   │◀── ACK ────────────────│
   │                         │
   │◀── FIN ────────────────│
   │                         │
   │──── ACK ──────────────▶│
   │                         │
   │      연결 종료 완료       │
```

### TCP 흐름 제어와 혼잡 제어

| 구분 | 흐름 제어 | 혼잡 제어 |
|------|----------|----------|
| 목적 | 수신자 버퍼 오버플로우 방지 | 네트워크 혼잡 방지 |
| 방법 | 슬라이딩 윈도우 | AIMD, Slow Start |
| 관점 | 송신자-수신자 간 | 네트워크 전체 |

---

## 4. HTTP/HTTPS

### HTTP 메서드

| 메서드 | 설명 | 멱등성 | 안전성 |
|--------|------|--------|--------|
| GET | 리소스 조회 | O | O |
| POST | 리소스 생성 | X | X |
| PUT | 리소스 전체 수정 | O | X |
| PATCH | 리소스 일부 수정 | X | X |
| DELETE | 리소스 삭제 | O | X |

### HTTP 상태 코드

| 범위 | 의미 | 예시 |
|------|------|------|
| 1xx | 정보 | 100 Continue |
| 2xx | 성공 | 200 OK, 201 Created |
| 3xx | 리다이렉션 | 301 Moved, 304 Not Modified |
| 4xx | 클라이언트 오류 | 400 Bad Request, 404 Not Found |
| 5xx | 서버 오류 | 500 Internal Error, 503 Unavailable |

### ⭕ HTTP와 HTTPS의 차이는?

| 구분 | HTTP | HTTPS |
|------|------|-------|
| 포트 | 80 | 443 |
| 보안 | 평문 전송 | SSL/TLS 암호화 |
| 인증서 | 불필요 | 필요 |
| 속도 | 빠름 | 약간 느림 (암호화 오버헤드) |

HTTPS는 HTTP에 SSL/TLS 암호화가 추가된 것으로, 인증서를 통해 서버를 검증하며 데이터를 암호화하여 전송한다.

### HTTP/2, HTTP/3

| 버전 | 특징 |
|------|------|
| HTTP/1.1 | Keep-Alive, 파이프라이닝 |
| HTTP/2 | 멀티플렉싱, 헤더 압축, 서버 푸시 |
| HTTP/3 | QUIC 프로토콜 (UDP 기반), 연결 지연 감소 |

---

## 5. DNS ◑

### ⭕ DNS란? 동작 원리를 설명하라

도메인 이름을 IP 주소로 변환하는 분산 데이터베이스 시스템이다.

**DNS 조회 과정:**
```
1. 브라우저/OS 로컬 캐시 확인
2. Recursive Resolver (ISP DNS) 쿼리
3. Root Name Server → TLD 서버 안내
4. TLD Server (.com) → Authoritative 서버 안내
5. Authoritative Name Server → IP 주소 반환
6. 결과 캐싱 (TTL 기간 동안)
```

| DNS 서버 종류 | 역할 |
|--------------|------|
| Root Server | TLD 서버 위치 안내 (13개 루트 존재) |
| TLD Server | .com, .org 등 도메인 확장자 관리 |
| Authoritative | 실제 도메인-IP 매핑 보유 |
| Recursive Resolver | 클라이언트 대신 재귀적 조회 수행 |

### DNS 레코드 타입 ◑

| 레코드 | 용도 |
|--------|------|
| A | 도메인 → IPv4 |
| AAAA | 도메인 → IPv6 |
| CNAME | 도메인 → 다른 도메인 (별칭) |
| MX | 메일 서버 지정 |
| NS | 네임서버 지정 |

---

## 6. IP 주소 체계 ◑

### IPv4 vs IPv6

| 구분 | IPv4 | IPv6 |
|------|------|------|
| 주소 길이 | 32비트 | 128비트 |
| 표기 | 10진수 (192.168.1.1) | 16진수 (2001:db8::1) |
| 주소 수 | 약 43억 개 | 거의 무한 |
| NAT 필요성 | 필요 | 불필요 |

### 서브넷과 CIDR

**CIDR 표기법**: `192.168.1.0/24` → 앞 24비트가 네트워크, 뒤 8비트가 호스트

| CIDR | 서브넷 마스크 | 호스트 수 |
|------|--------------|----------|
| /24 | 255.255.255.0 | 254 |
| /16 | 255.255.0.0 | 65,534 |
| /8 | 255.0.0.0 | 16,777,214 |

### ⭕ ARP(Address Resolution Protocol)란? ◑

IP 주소를 MAC 주소로 변환하는 프로토콜이다.

**동작 과정:**
1. ARP Request 브로드캐스트 (목적지 IP의 MAC 주소 질의)
2. 해당 IP 보유 장치가 ARP Reply 유니캐스트
3. 결과를 ARP 캐시에 저장

### ⭕ NAT(Network Address Translation)란? ◑

사설 IP를 공인 IP로 변환하여 여러 장치가 하나의 공인 IP를 공유하게 하는 기술이다.

| 유형 | 설명 |
|------|------|
| Static NAT | 1:1 매핑 |
| Dynamic NAT | 공인 IP 풀에서 동적 할당 |
| PAT/NAPT | 포트 번호로 구분 (가장 일반적) |

---

## 7. 네트워크 장비

### ⭕ Hub, Switch, Router의 차이는?

| 장비 | 계층 | 역할 |
|------|------|------|
| **Hub** | L1 (물리) | 모든 포트로 브로드캐스트 |
| **Switch** | L2 (데이터링크) | MAC 주소 기반 프레임 전달 |
| **Router** | L3 (네트워크) | IP 주소 기반 패킷 라우팅 |
| **공유기** | L3-L7 | 라우터 + NAT + DHCP + 방화벽 |

---

## 8. 소켓 프로그래밍 ◑

### ⭕ 소켓(Socket)이란?

네트워크 통신의 종단점(endpoint)으로, IP 주소와 포트 번호의 조합이다. 운영체제가 제공하는 네트워크 통신 인터페이스이다.

### 소켓 통신 흐름 ◑

**TCP 서버:**
```
socket() → bind() → listen() → accept() → recv()/send() → close()
```

**TCP 클라이언트:**
```
socket() → connect() → recv()/send() → close()
```

**UDP (서버/클라이언트):**
```
socket() → bind() → recvfrom()/sendto() → close()
```

### 소켓 API 주요 함수 ◑

| 함수 | 설명 |
|------|------|
| `socket()` | 소켓 생성 (파일 디스크립터 반환) |
| `bind()` | 소켓에 주소(IP+Port) 바인딩 |
| `listen()` | 연결 대기 상태로 전환 (백로그 큐 설정) |
| `accept()` | 연결 수락, 새 소켓 반환 |
| `connect()` | 서버에 연결 요청 |
| `send()/recv()` | 데이터 송수신 (TCP) |
| `sendto()/recvfrom()` | 데이터 송수신 (UDP) |
| `close()` | 소켓 종료 |

### ⭕ Blocking vs Non-Blocking I/O ◑

| 구분 | Blocking | Non-Blocking |
|------|----------|--------------|
| 동작 | 작업 완료까지 대기 | 즉시 반환 |
| 반환값 | 결과 또는 에러 | 결과, EAGAIN, 또는 에러 |
| 장점 | 구현 단순 | 다른 작업 가능 |
| 단점 | 스레드 차단 | 폴링 필요, 구현 복잡 |

### ⭕ I/O 멀티플렉싱이란? ◑

하나의 스레드에서 여러 I/O를 동시에 감시하고 처리하는 기법이다.

| 방식 | 특징 | 한계 |
|------|------|------|
| **select()** | POSIX 표준, 이식성 좋음 | fd 수 제한 (1024), 매번 전체 검사 |
| **poll()** | fd 수 제한 없음 | 매번 전체 검사 O(n) |
| **epoll** (Linux) | 이벤트 기반, 효율적 | Linux 전용 |
| **kqueue** (BSD) | 이벤트 기반 | BSD/macOS 전용 |
| **IOCP** (Windows) | 비동기 I/O | Windows 전용 |

### epoll 동작 방식 ◑

```c
// 1. epoll 인스턴스 생성
int epfd = epoll_create(1);

// 2. 관심 이벤트 등록
epoll_ctl(epfd, EPOLL_CTL_ADD, sockfd, &event);

// 3. 이벤트 대기
int n = epoll_wait(epfd, events, MAX_EVENTS, timeout);

// 4. 발생한 이벤트만 처리
for (int i = 0; i < n; i++) {
    // events[i] 처리
}
```

| 모드 | 설명 |
|------|------|
| **Level Triggered (LT)** | 조건 만족 시 계속 알림 (기본) |
| **Edge Triggered (ET)** | 상태 변화 시에만 알림 (고성능) |

### 동시 접속 처리 모델 ◑

| 모델 | 설명 | 장단점 |
|------|------|--------|
| **멀티 프로세스** | 연결당 fork() | 격리 좋음, 오버헤드 큼 |
| **멀티 스레드** | 연결당 스레드 | 공유 자원, 컨텍스트 스위칭 |
| **I/O 멀티플렉싱** | 단일 스레드 + select/epoll | 고성능, 복잡한 구현 |
| **비동기 I/O** | IOCP, io_uring | 최고 성능, 구현 난이도 높음 |

### C10K Problem ◑

동시 10,000개 연결 처리 문제. 전통적인 스레드/프로세스 모델의 한계를 드러냈으며, 이벤트 기반 아키텍처(Node.js, Nginx)와 I/O 멀티플렉싱으로 해결한다.

---

## 면접 대비 체크리스트 ◑

- [ ] OSI 7계층 vs TCP/IP 4계층
- [ ] TCP vs UDP 차이
- [ ] TCP 3-way / 4-way Handshake
- [ ] HTTP 메서드와 멱등성
- [ ] HTTP vs HTTPS
- [ ] HTTP/2, HTTP/3 특징
- [ ] DNS 동작 원리
- [ ] IPv4 vs IPv6
- [ ] ARP 프로토콜
- [ ] NAT 동작 원리
- [ ] Hub, Switch, Router 차이
- [ ] 소켓 API 함수 흐름 (TCP/UDP)
- [ ] Blocking vs Non-Blocking I/O
- [ ] I/O 멀티플렉싱 (select, poll, epoll)
- [ ] C10K Problem과 해결 방법
